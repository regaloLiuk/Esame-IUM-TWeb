<!DOCTYPE html>
<html lang="en">
<head>
    <title>Pagina Principale</title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link rel="canonical" href="https://getbootstrap.com/docs/4.3/examples/sign-in/">
    <!--script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    <!--script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script-->
    <!--script>window.jQuery || document.write('<script src="/docs/4.3/assets/js/vendor/jquery-slim.min.js"><\/script>')</script-->

    <!--script src="bootstrap-4.1.3-dist/js/bootstrap.bundle.min.js" integrity="sha384-xrRywqdh3PHs8keKZN+8zzc5TX0GRTLCcmivcbNJWm2rs5C8PRhcEn3czEjhAO9o" crossorigin="anonymous"></script-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/feather-icons/4.9.0/feather.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.3/Chart.min.js"></script>


    <style>
        .bd-placeholder-img {
            font-size: 1.125rem;
            text-anchor: middle;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        @media (min-width: 768px) {
            .bd-placeholder-img-lg {
                font-size: 3.5rem;
            }
        }
    </style>
    <!-- Custom styles for this template -->
    <link href="bootstrap-4.1.3-dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="Profilo.css" rel="stylesheet">
    <link href="dashboard.css" rel="stylesheet">
    <style type="text/css">
    /* Chart.js  metodo per animazioni
    @-webkit-keyframes chartjs-render-animation{
        from{opacity:0.99}
        to{opacity:1}
    }@keyframes chartjs-render-animation{
             from{opacity:0.99}
             to{opacity:1}
    }.chartjs-render-monitor{-webkit-animation:chartjs-render-animation 0.001s;
                   animation:chartjs-render-animation 0.001s;
    }*/
    </style>
</head>
<body>
<form method="post"/>
<nav class="navbar navbar-dark fixed-top bg-dark flex-md-nowrap p-0 shadow">
    <div class="navbar-brand col-sm-3 col-md-2 mr-0">
            <div id="username" class="outputTextArea"></div>
    </div>
    <ul class="navbar-nav px-3">
        <li class="nav-item text-nowrap">
            <!--form method="post"/-->
            <button type="button" id="logout" class="btn btn-link">Sign out</button>
            <!--/form-->
        </li>
    </ul>
</nav>
</form>

<div class="container-fluid">
    <div class="row">
        <nav class="col-md-2 d-none d-md-block bg-light sidebar">
            <div class="sidebar-sticky">
                <ul class="nav flex-column">
                    <li class="nav-item">
                        <a class="nav-link" href="#" onclick="prenota()">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-home">
                                <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                                <polyline points="9 22 9 12 15 12 15 22"></polyline>
                            </svg>
                            Prenota
                            <span class="sr-only">(current)</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" onclick="profilo()">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-users">
                                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle>
                                <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                            </svg>
                            Profilo
                        </a>
                    </li>
                </ul>
            </div>
        </nav>

        <main role="main" class="col-md-9 ml-sm-auto col-lg-10 px-4">
            <div class="chartjs-size-monitor" style="position: absolute; left: 0px; top: 0px; right: 0px; bottom: 0px; overflow: hidden; pointer-events: none; visibility: hidden; z-index: -1;">
                <div class="chartjs-size-monitor-expand" style="position:absolute;left:0;top:0;right:0;bottom:0;overflow:hidden;pointer-events:none;visibility:hidden;z-index:-1;">
                    <div style="position:absolute;width:1000000px;height:1000000px;left:0;top:0"></div>
                </div>
                <div class="chartjs-size-monitor-shrink" style="position:absolute;left:0;top:0;right:0;bottom:0;overflow:hidden;pointer-events:none;visibility:hidden;z-index:-1;">
                <div style="position:absolute;width:200%;height:200%;left:0; top:0">
                </div>
            </div>
            </div>

            <canvas class="my-4 w-100 chartjs-render-monitor" id="myChart" width="85" height="35" style="display: block; width: 85px; height: 35px;"></canvas>

            <div id="pagina">
                <form method="post">
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <label class="input-group-text" for="GIORNI">Giorno</label>
                        </div>
                        <select class="custom-select" id="GIORNI" name="GIORNI">
                            <option selected>giorno</option>
                            <option value="lunedì">lunedì</option>
                            <option value="martedì">martedì</option>
                            <option value="mercoledì">mercoledì</option>
                            <option value="giovedì">giovedì</option>
                            <option value="venerdì">venerdì</option>
                        </select>
                        <div class="input-group-prepend">
                            <label class="input-group-text" for="ORARI">Ora</label>
                        </div>
                        <select class="custom-select" id="ORARI" name="ORARI">
                            <option selected>ora</option>
                            <option value="15">15</option>
                            <option value="16">16</option>
                            <option value="17">17</option>
                            <option value="18">18</option>
                            <option value="19">19</option>
                        </select>
                    </div>
                    <div id="outCorsi" class="outputTextArea"></div>
                    <div id="outDocenti" class="outputTextArea"></div>
                    <input type="button" value="cerca" onclick="cerca()" class="btn btn-primary btn-lg">
                    </br>
                    <div id="ripetizioniWeb" class="outputTextArea"></div>
                </form>
            </div>
        </main>
    </div>
</div>

<script type="text/javascript">
    function prenota() {
        var ris =   "<form method=\"post\">\n" +
                    "                    <div class=\"input-group mb-3\">\n" +
                    "                        <div class=\"input-group-prepend\">\n" +
                    "                            <label class=\"input-group-text\" for=\"GIORNI\">Giorno</label>\n" +
                    "                        </div>\n" +
                    "                        <select class=\"custom-select\" id=\"GIORNI\" name=\"GIORNI\">\n" +
                    "                            <option selected>giorno</option>\n" +
                    "                            <option value=\"lunedì\">lunedì</option>\n" +
                    "                            <option value=\"martedì\">martedì</option>\n" +
                    "                            <option value=\"mercoledì\">mercoledì</option>\n" +
                    "                            <option value=\"giovedì\">giovedì</option>\n" +
                    "                            <option value=\"venerdì\">venerdì</option>\n" +
                    "                        </select>\n" +
                    "                        <div class=\"input-group-prepend\">\n" +
                    "                            <label class=\"input-group-text\" for=\"ORARI\">Ora</label>\n" +
                    "                        </div>\n" +
                    "                        <select class=\"custom-select\" id=\"ORARI\" name=\"ORARI\">\n" +
                    "                            <option selected>ora</option>\n" +
                    "                            <option value=\"15\">15</option>\n" +
                    "                            <option value=\"16\">16</option>\n" +
                    "                            <option value=\"17\">17</option>\n" +
                    "                            <option value=\"18\">18</option>\n" +
                    "                            <option value=\"19\">19</option>\n" +
                    "                        </select>\n" +
                    "                    </div>\n" +
                    "                    <div id=\"outCorsi\" class=\"outputTextArea\"></div>\n" +
                     "                   <div id=\"outDocenti\" class=\"outputTextArea\"></div>\n" +
                    "                    <input type=\"button\" value=\"cerca\" onclick=\"cerca()\" class=\"btn btn-primary btn-lg\">\n" +
                    "                    </br>\n" +
                    "                    <div id=\"ripetizioniWeb\" class=\"outputTextArea\"></div>\n" +
                    "                </form>";
                document.getElementById("pagina").innerHTML = ris;
        $(document).ready(function () { // When the DOM of this page is constructed
            $.post("Servlet", {action: "corsi"}, // POST to WeatherServlet!!
                function (data) {// callBack function
                    console.log('-' + data + '-');
                    obj = JSON.parse(data);
                    var d = "<div id=\"corsi\" class=\"input-group mb-3\">\n" +
                        "<div class=\"input-group-prepend\">\n" +
                        "<label class=\"input-group-text\" for=\"MATERIE\">Materie</label>\n" +
                        "</div>\n" +
                        "<select class=\"custom-select\" id=\"MATERIE\" name=\"MATERIE\">"+
                        "<option selected>materia</option>\n";
                    for (var i = 0; i < obj.Corsi.length; i++) {
                        var counter = obj.Corsi[i];
                        d += "<option>" + counter.materia+ "</option>\n";
                    }
                    d+= "</select>\n" +
                        "</div>";
                    $("#outDocenti").html(d); // Select element weatherReport (by ID) and insert dynamic content (data) into it
                });
        });

        $(document).ready(function () { // When the DOM of this page is constructed
            $.post("Servlet", {action: "docenti"}, // POST to WeatherServlet!!
                function (data) {// callBack function
                    console.log('-' + data + '-');
                    obj = JSON.parse(data);
                    var c = "<div id=\"docenti\" class=\"input-group mb-3\">\n" +
                        "<div class=\"input-group-prepend\">\n" +
                        "<label class=\"input-group-text\" for=\"PROFESSORI\">Professori</label>\n" +
                        "</div>\n" +
                        "<select class=\"custom-select\" id=\"PROFESSORI\" name=\"PROFESSORI\">\n"+
                        " <option selected>professore</option>";
                    for (var i = 0; i < obj.Docenti.length; i++) {
                        var counter = obj.Docenti[i];
                        c += "<option value=\""+ counter.ID +"\">" + counter.NOME + " " + counter.COGNOME +"</option>\n";
                    }
                    c+= "</select>\n" +
                        "</div>";
                    $("#outCorsi").html(c); // Select element weatherReport (by ID) and insert dynamic content (data) into it
                });
        });
        }

    function cerca() {
        $(document).ready(function () { // When the DOM of this page is constructed
            var mat = document.getElementById("MATERIE").value;//sets "city" to value of "cityName" from DOM
            var prof = document.getElementById("PROFESSORI").value;//sets "city" to value of "cityName" from DOM
            var ora = document.getElementById("ORARI").value;//sets "city" to value of "cityName" from DOM
            var gg = document.getElementById("GIORNI").value;//sets "city" to value of "cityName" from DOM
            $.post("Servlet", {mat: mat, prof: prof, ora: ora, gg: gg, action: "ripetizioniWeb"}, // POST to WeatherServlet!!
                function (data) {   // callBack function
                    console.log('-' + data + '-');
                    obj = JSON.parse(data);
                    if(obj.Ripetizioni == null)
                        alert("inserire parametri di ricerca");
                    var tab = "<table class=\"table\">\n" +
                        "  <thead>\n" +
                        "    <tr>\n" +
                        "      <th scope=\"col\">Materia</th>\n" +
                        "      <th scope=\"col\">Professore</th>\n" +
                        "      <th scope=\"col\">Giorno</th>\n" +
                        "      <th scope=\"col\">Ora</th>\n" +
                        "    </tr>\n" +
                        "  </thead>\n" +
                        "  <tbody>";
                    for (var i = 0; i < obj.Ripetizioni.length; i++) {
                        var counter = obj.Ripetizioni[i];
                        tab += "<tr>\n" +
                            "      <th>" + counter.MATERIA + "</th>\n" +
                            "      <td>" + counter.PROF + "</td>\n" +
                            "      <td>" + counter.GIORNO + "</td>\n" +
                            "      <td>" + counter.ORA + "</td>\n" +
                            "      <td><button type=\"button\" onclick=\"riserva(" + "'"+counter.MATERIA+"'" + "," + "'"+counter.PROF+"'" + "," +counter.IDPROF+ "," + "'"+counter.GIORNO+"'" + "," + counter.ORA+ ")\" class=\"btn btn-success btn-sm\">Prenota</button></td>\n" +
                            "    </tr>";
                    }
                    tab += "</tbody>\n" +
                        "</table>";
                    $("#ripetizioniWeb").html(tab); // Select element weatherReport (by ID) and insert dynamic content (data) into it
                });
        });
    }

    function profilo() {
        var p = "<div class=\"media\">\n" +
                "  <img src=\"immagini/download.png\" class=\"align-self-start mr-3\" style=\"max-width:100px\" alt=\"...\">\n" +
                "  <div class=\"media-body\">\n" +
                "    <h5 class=\"mt-0\">Dati personali</h5>\n" +
                "       <form method=\"post\"/>\n"+
                "           <table class=\"table table-borderless\">\n" +
                "               <tbody>\n" +
                "                   <tr>\n" +
                "                       <th scope=\"row\">Nome</th>\n" +
                "                       <td> <div id=\"nome\" class=\"outputTextArea\"></div> </td>\n" +
                "                   </tr>\n" +
                "                   <tr>\n" +
                "                       <th scope=\"row\">Cognome</th>\n" +
                "                       <td> <div id=\"cognome\" class=\"outputTextArea\"></div> </td>\n" +
                "                   </tr>\n" +
                "                   <tr>\n" +
                "                       <th scope=\"row\">Email</th>\n" +
                "                       <td> <div id=\"email\" class=\"outputTextArea\"></div> </td>\n" +
                "                   </tr>\n" +
                "               </tbody>\n" +
                "           </table>" +
                "       </form>\n"+
                "  </div>\n" +
                "</div>\n" +
                "<button type=\"button\" onclick=\"storicoWeb()\" class=\"btn btn-primary btn-lg btn-block\">Mostra ripetizioni prenotate</button>\n"+
                "<div id=\"storico\" class=\"outputTextArea\"></div>\n";
        document.getElementById("pagina").innerHTML = p;
        $(document).ready(function () { // When the DOM of this page is constructed
            $.post("Servlet", {action: "datipersonali"}, // POST to WeatherServlet!!
                function (data) {   // callBack function
                    console.log('-' + data + '-');
                    obj = JSON.parse(data);
                    if (obj.Utente != null) {
                        $("#nome").html(obj.Utente["nome"]); // Select element weatherReport (by ID) and insert dynamic content (data) into it
                        $("#cognome").html(obj.Utente["cognome"]); // Select element weatherReport (by ID) and insert dynamic content (data) into it
                        $("#email").html(obj.Utente["email"]); // Select element weatherReport (by ID) and insert dynamic content (data) into it
                    }else{
                        alert("ERRORE RICEZIONE UTENTE")
                    }
            });
        });
    }

    function storicoWeb() {
        var tab;

        $(document).ready(function () { // When the DOM of this page is constructed
            $.post("Servlet", {action: "storicoWeb"}, // POST to WeatherServlet!!
                function (data) {   // callBack function
                    console.log('-' + data + '-');
                    obj = JSON.parse(data);
                    if(obj.Storico == null)
                        $("#storico").html("Non ci sono ripretizioni prenotate");
                    tab =  "    <table class= \"table\">\n" +
                            "    <thead>\n" +
                            "    <tr>\n" +
                            "        <th>Materia</th>\n" +
                            "        <th>Professore</th>\n" +
                            "        <th>Giorno</th>\n" +
                            "        <th>Ora</th>\n" +
                            "    </tr>\n" +
                            "    </thead>\n" +
                            "    <tbody>\n";
                    for (var i = 0; i < obj.Storico.length; i++) {
                        var counter = obj.Storico[i];
                        if (counter.STATO == 0) {
                            tab +=  "<tr>\n" +
                                    "      <td class=\"table-light\">" + counter.MATERIA + "</td>\n" +
                                    "      <td class=\"table-light\">" + counter.PROF + "</td>\n" +
                                    "      <td class=\"table-light\">" + counter.GIORNO + "</td>\n" +
                                    "      <td class=\"table-light\">" + counter.ORA + "</td>\n" +
                                    "      <td><button type=\"button\" onclick=\"effettua(" + "'"+counter.MATERIA+"'" + "," +counter.IDPROF+ "," + "'" +counter.GIORNO+ "'" + "," + counter.ORA+ ")\" class=\"btn btn-success btn-sm\">Effettua</button></td>\n" +
                                    "      <td><button type=\"button\" onclick=\"elimina(" + "'"+counter.MATERIA+"'" + "," +counter.IDPROF+ "," + "'" +counter.GIORNO+ "'" + "," + counter.ORA+ ")\" class=\"btn btn-danger btn-sm\">Elimina</button></td>\n" +
                                    "</tr>";
                        }else{
                            tab +=  "<tr>\n" +
                                    "      <td class=\"table-secondary\">" + counter.MATERIA + "</td>\n" +
                                    "      <td class=\"table-secondary\">" + counter.PROF + "</td>\n" +
                                    "      <td class=\"table-secondary\">" + counter.GIORNO + "</td>\n" +
                                    "      <td class=\"table-secondary\">" + counter.ORA + "</td>\n" +
                                    "</tr>";
                        }
                        //console.log('-' + "S.materia" + i + '-');
                    }
                    tab +=  "    </tbody>\n" +
                        "    </table>\n";
                    $("#storico").html(tab); // Select element weatherReport (by ID) and insert dynamic content (data) into it

                });
        });
    }

    function elimina(materia, professore, giorno, ora) {
        $(document).ready(function () { // When the DOM of this page is constructed
            console.log('-'+ materia + ' ' + professore + ' ' + giorno + ' ' + ora + '-');
            $.post("Servlet", {mat: materia, prof: professore, ora: ora, gg: giorno, action: "elimina"},
                function (data) {   // callBack function
                    if(data === "ok")
                        storicoWeb();
                    else
                        alert("errore")

                });
        });
    }

    function effettua(materia, professore, giorno, ora) {
        $(document).ready(function () { // When the DOM of this page is constructed
            console.log('-'+ materia + ' ' + professore + ' ' + giorno + ' ' + ora + '-');
            $.post("Servlet", {mat: materia, prof: professore, ora: ora, gg: giorno, action: "effettua"},
                function (data) {   // callBack function
                    if(data === "ok")
                        storicoWeb();
                    else
                        alert("errore")

                });
        });
    }

    function riserva(materia, professore, idprof, giorno, ora){
        $(document).ready(function () { // When the DOM of this page is constructed
            $.post("Servlet", {mat: materia, prof: professore, idprof: idprof, ora: ora, gg: giorno, action: "riserva"},
                function (data) {   // callBack function
                    if(data === "ok")
                        cerca();
                    else
                        alert("errore")
                });
        });
    }

    $(document).ready(function () { // When the DOM of this page is constructed
        $("#logout").click(function () {// on click of getWeatherReport button do ...
            $.post("Servlet", {action: "logout"}, // POST to WeatherServlet!!
                function (data) {   // callBack function
                    console.log('-' + data + '-');
                    if (data === 'ok') {
                        document.location.href = "index.html";
                    }else{
                        alert("ERRORE");
                    }
                });
        });
    });

    $(document).ready(function () { // When the DOM of this page is constructed
        $.post("Servlet", {action: "nomeUtente"}, // POST to WeatherServlet!!
            function (data) {   // callBack function
                $("#username").html(data); // Select element weatherReport (by ID) and insert dynamic content (data) into it
            });
    });

    $(document).ready(function () { // When the DOM of this page is constructed
        $.post("Servlet", {action: "corsi"}, // POST to WeatherServlet!!
            function (data) {// callBack function
                console.log('-' + data + '-');
                obj = JSON.parse(data);
                var d = "<div id=\"corsi\" class=\"input-group mb-3\">\n" +
                    "<div class=\"input-group-prepend\">\n" +
                    "<label class=\"input-group-text\" for=\"MATERIE\">Materie</label>\n" +
                    "</div>\n" +
                    "<select class=\"custom-select\" id=\"MATERIE\" name=\"MATERIE\">"+
                    "<option selected>materia</option>\n";
                for (var i = 0; i < obj.Corsi.length; i++) {
                    var counter = obj.Corsi[i];
                    d += "<option>" + counter.materia+ "</option>\n";
                }
                d+= "</select>\n" +
                    "</div>";
                $("#outDocenti").html(d); // Select element weatherReport (by ID) and insert dynamic content (data) into it
            });
    });

    $(document).ready(function () { // When the DOM of this page is constructed
        $.post("Servlet", {action: "docenti"}, // POST to WeatherServlet!!
            function (data) {// callBack function
                console.log('-' + data + '-');
                obj = JSON.parse(data);
                var c = "<div id=\"docenti\" class=\"input-group mb-3\">\n" +
                    "<div class=\"input-group-prepend\">\n" +
                    "<label class=\"input-group-text\" for=\"PROFESSORI\">Professori</label>\n" +
                    "</div>\n" +
                    "<select class=\"custom-select\" id=\"PROFESSORI\" name=\"PROFESSORI\">\n"+
                    " <option selected>professore</option>";
                for (var i = 0; i < obj.Docenti.length; i++) {
                    var counter = obj.Docenti[i];
                    c += "<option value=\""+ counter.ID +"\">" + counter.NOME + " " + counter.COGNOME +"</option>\n";
                }
                c+= "</select>\n" +
                    "</div>";
                $("#outCorsi").html(c); // Select element weatherReport (by ID) and insert dynamic content (data) into it
            });
    });


</script>

</body>
</html>
